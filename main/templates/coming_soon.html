{% extends "base.html" %} 
{% load static %} 

{% block title %}Coming Soon | House of Gaia{% endblock %} 

{% block description %}Weâ€™re almost ready to launch something beautiful. Stay tuned!{% endblock %} 
{% block og_title %}Coming Soon | House of Gaia{% endblock %} 
{% block og_description %}A new luxury piercing studio is on the way!{% endblock %} 
{% block content %}
<div class="container">
	<div class="left">
		<h4>Coming Soon!</h4>
		<p>We're currently working on something fantastic.</p>
		<form action="#" method="post" target="_blank" id="newsletter-form">
				<div class="input-wrapper">
					<input 
						type="email" 
						name="fields[email]" 
						placeholder="Email" 
						autocomplete="email" 
						pattern="[a-zA-Z0-9._%+\-]+@[a-zA-Z0-9.\-]+\.[a-zA-Z]{2,}$"
						title="Please enter a valid email address."
						required
						>
						<button type="submit">
							<i></i>
						</button>
						
				</div>
				<div class="g-recaptcha" data-sitekey="6LcN9iUrAAAAAGIBSjKASbvEKFmxPUcBRnthBrbs"></div>
			</form>
			<div style="display: flex; justify-content: center; align-items: center;">
				<div class="preloader-wrapper active" id="loader" style="margin: 10px auto; display: none;">
					<div class="spinner-layer spinner-blue-only">
						<div class="circle-clipper left">
							<div class="circle"></div>
						</div>
						<div class="gap-patch">
							<div class="circle"></div>
						</div>
					</div>
				</div>
			</div>


		<div id='thankYouMsg' class='thankYouMsg' ><p>Thank you for subscribing!</p> </div>

		

		<div class="icons">
			<div><img src="{% static 'icons/facebook.png' %}" alt="Facebook Icon" /></div>
			<div><img src="{% static 'icons/instagram.png' %}" alt="Instagram Icon" /></div>
			<div><img src="{% static 'icons/tiktok.png' %}" alt="TikTok Icon" /></div>
		</div>
	</div>

	<div class="right">
		<div class='overlay'> </div>
		<img src="{% static 'icons/baseWallpaper.jpeg' %}" alt="Base Wallpaper"  />
	</div>
</div>



<script>
	
	jQuery(document).ready(function () {
		jQuery('#newsletter-form').on('submit', function (e) {
			e.preventDefault();
			const email = jQuery('input[name="fields[email]"]').val();
			const emailPattern = /^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/;
			if (!emailPattern.test(email)) {
				M.toast({html: 'Please enter a valid email address.'});
				return;
			}
			jQuery('#loader').fadeIn();
		
				try {
					const recaptchaResponse = grecaptcha.getResponse();
					if (recaptchaResponse.length === 0) {
						M.toast({html: 'Please complete the CAPTCHA.'});
						jQuery('#loader').fadeOut();
						return;
					}

			
					jQuery.ajax({
						url: 'https://assets.mailerlite.com/jsonp/1479163/forms/152673411254978402/subscribe',
						dataType: 'jsonp',
						data: {
							'fields[email]': email,
							'g-recaptcha-response': recaptchaResponse
						},
						success: function (response) {
							jQuery('#loader').fadeOut();
							if (response.success) {
								document.getElementById("newsletter-form").style.display = "none";
								document.getElementById("thankYouMsg").style.display = "block";
								M.toast({html: 'Thank you for subscribing.'});
								jQuery('#newsletter-form')[0].reset();
							} else {
								console.log('Error response:', response);
								M.toast({html: 'Something went wrong.'});
							}
				},
				error: function (xhr, status, error) {
					jQuery('#loader').fadeOut();
					console.error('AJAX error:', error);
					M.toast({html: 'Server error. Please try again later.'});
				}
			});
		} catch (err) {
			jQuery('#loader').fadeOut();
			console.error('reCAPTCHA error:', err);
			M.toast({html: 'reCAPTCHA failed. Please try again.'});
			}
		});
		});
	;
</script>



{% endblock %}